<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

  <head>
    <title>
      packages/sispmctl – Freetz
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="/search" />
        <link rel="help" href="../TracGuide.html" />
        <link rel="alternate" href="sispmctl%3Fformat=txt" type="text/x-trac-wiki" title="Reiner Text" />
        <link rel="up" href="../packages.html" title="Übergeordnete Wiki-Seite anzeigen" />
        <link rel="start" href="/wiki" />
        <link rel="stylesheet" href="../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikiextras/css/phrases.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikiextras/css/boxes.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikiextras/css/boxes-300.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikiextras/css/boxes-narrow-toc.css" type="text/css" /><link rel="stylesheet" href="../../wikicss.css" type="text/css" /><link rel="stylesheet" href="../../chrome/tags/css/tractags.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikinegotiator/css/langmenu-ctxnav.css" type="text/css" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="/favicon.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="/search/opensearch" title="Freetz durchsuchen" />
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/messages/de.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/folding.js"></script>
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="/wiki"><img src="../../chrome/common/freetz_motd.png" alt="Freetz" /></a>
      </div>
      <form id="search" action="https://www.google.com/search" method="get" onsubmit="; this.elements.namedItem('q').value = this.elements.namedItem('oq').value + ' site:freetz.github.io'">
        <div>
          <label for="proj-search">Suche:</label>
          <input type="text" id="proj-search" name="oq" size="18" value="" />
          <input type="hidden" name="q" value="" />
          <input type="submit" value="Suche" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><li class="last"><a href="../Impressum.html">Impressum</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="/wiki">Wiki</a></li><li><a href="https://github.com/Freetz/freetz/commits/master">Quellen durchsehen</a></li><li class="last"><a href="/screenshots">Bildschirmfotos</a></li>
    </ul>
  </div>
    <div id="langmenu"><ul><li class="first"><span title="Select a language of wiki content">Language:</span></li><li class=" active"><a class="" href="sispmctl.html" title="displaying language (default)">German</a></li><li class=" last"><a class=" notexist" href="/wiki/packages/sispmctl.en" title="(not available)">English</a></li></ul></div><p /><div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="Zeige WikiStart an" href="/wiki">Wiki:</a><a class="pathentry" href="../packages.html" title="Zeige packages an">packages</a><span class="pathentry sep">/</span><a class="pathentry" href="sispmctl.html" title="Zeige packages/sispmctl an">sispmctl</a>
</div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">

          <div id="wikipage" class="trac-content"><h1 id="sispmctl">sispmctl</h1>
<p>
<strong><a class="ext-link" href="http://sispmctl.sourceforge.net/"><span class="icon">​</span>sispmctl</a></strong> ermöglicht das Schalten von 230V-Steckdosen über den USB-Anschluss der Fritzbox (nur für Fritzboxen mit USB-Host-Anschluss). Es unterstützt die USB-Steckdosen GEMBIRD Silvershield SIS-PM, SIS-PMS und mSIS-PM. Diese USB-Steckdosen sind deutlich günstiger zu bekommen als Steckdosen, die übers Netzwerk geschaltet werden. Dank der Fähigkeiten von Freetz können diese Steckdosen auch per Internet und per Telefon geschaltet werden.
</p>
<h2 id="Einschränkung">Einschränkung</h2>
<p>
sispmctl läuft leider nicht auf Boxen, die den USB-Low-Speed-Modus nicht unterstützen. Zu diesen Boxen gehört z.B. die alt bekannte 7170. Der Grund dafür liegt darin, dass der USB-Controller solcher Boxen in einem FPGA realisiert ist und von AVM nur sehr spärlich programmiert wurde. Da dieser Teil der Firmware zum Closed-Source-Bereich gehört, sehen wir leider keine große Chancen, dass sich die Situation in der nächsten Zeit verbessern wird. Wenn sich jemand damit auskennt, ist er dennoch herzlich eingeladen den USB-Controller einer 7170 dazu zu ertüchtigen, mit den Steckdosenleisten von GEMBIRD zu reden.
</p>
<p>
Liste der Boxen, mit denen sispmctl <span class="underline"><strong>nicht</strong></span> funktioniert: alle x1xx Modelle z.B. <strong>3131</strong>, <strong>7141</strong>, <strong>7170</strong>  <br />
Liste der Boxen, mit denen sispmctl funktioniert: <strong>3370</strong>, <strong>7270</strong>, <strong>W920V</strong> (<a class="ext-link" href="http://www.ip-phone-forum.de/showthread.php?t=172137"><span class="icon">​</span>Speedport2Fritz</a>)
</p>
<h2 id="Benutzung">Benutzung</h2>
<p>
<strong>sispmctl</strong> kann einerseits per Kommandozeile benutzt werden (telnet/ssh), andererseits enthält es einen kleinen Webserver, der das Schalten der Steckdosen ermöglicht. Der eingebaute Webserver enthält leider keine Möglichkeit zur Authentifizierung, so dass auch bei Benutzung von https (xrelayd, matrixtunnel) von der Verwendung übers Internet abzuraten ist. Es ist leider ohne Weiteres nicht möglich den integrierten Webserver über inetd laufen zu lassen, da sispmctl nur rudimentär Listener-Mode unterstützt. Selbst im Listener-Mode unterstützt sispmctl-Binary nicht die echte Daemon-Funktionalität. Aus diesem Grund muss der integrierte Webserver mit einem &amp; am Ende in den Hintergrund geschickt werden, um eine Daemon-ähnliche Funktionsweise abzubilden.
</p>
<p>
Die Steckdosenleiste kann, wenn sie direkt an einem Windows-Rechner angeschlossen ist, über die mitgelieferte Software auch so eingestellt werden, dass sie unabhängig vom Rechner zu bestimmten Zeitpunkten Schaltvorgänge ausführt. Diese Fähigkeit unterstützt <strong>sispmctl</strong> seit Version 3.0 (30.03.2011). Da diese Funktionalität noch ziemlich neu ist, wird sie oft auch durch andere Pakete in Freetz realisiert:
</p>
<ul><li><strong>cron</strong>: zeitgesteuertes Schalten
</li><li><strong>callmonitor</strong>: Schalten per Telefon (ohne Annahme des Gesprächs).
</li><li><strong>dtmfbox</strong>: Schalten per Telefon (mit Annahme des Gesprächs; per DTMF).
</li><li><strong>dropbear (ssh)</strong>: Schalten übers Internet.
</li><li><strong>apache/lighthttpd/busybox-httpd, haserl/php und xrelayd/matrixtunnel</strong>: Schalten per Web-Interface.
</li></ul><h2 id="FreetzWebinterface">Freetz Webinterface</h2>
<p>
<figure><img src="/screenshots/207.jpg" alt="CGI zur Einrichtung von sispmctl" /><figcaption>CGI zur Einrichtung von sispmctl</figcaption></figure>
Seit Mitte März 2011 wurden die ersten Versuche unternommen, eine Konfigurationsseite für FREETZ und einen rc-Startskript zu entwickeln. Näheres s. unter weiterführenden Links.
</p>
<p>
Die Version 1.0 von sispmctl-cgi erlaubt das Wählen zwei zusätzlicher Skins über menuconfig. Insbesonders "smartphone"-Skin ist minimalistisch gestaltet und bestens für Kleingeräte zugeschnitten. Auf der Einstellungsseite kann man "on-the-box" zwischen den Skins umschalten.
</p>
<p>
Seit Version 1.1 von sispmctl-cgi besteht die Möglichkeit mehrere Steckdosenleisten (bis 9) zu konfigurieren und einzelnen Steckdosen Namen zu vergeben. Diese benutzerdefinierten Bezeichnungen werden in FREETZ-Einstellungen abgespeichert und vom integrierten Webserver dank einer Parser-Funktion im rc-Skript dargestellt. Um mehrere Steckdosenleisten per integriertes Webinterface bedienen zu können, werden mehrere Instanzen von sispmctl als Listener auf unterschiedlichen Ports gestartet. Diese Ports können über die Einstellungsseite separat für jede Steckdosenleiste konfiguriert werden.
</p>
<p>
Seit Trunkversion <a class="changeset" href="/changeset/6789" title=" * sispmctl:
  * Bump to version 3.0
  * Add webinterface
  * by hermann
  ...">r6789</a> ist sispmctl 3.0 samt cgi-Version 1.1 ein Bestandteil von FREETZ und kann über menuconfig unter "Testing" ausgewählt werden. CGI-Version und rc-Skript kann in menuconfig separat abgewählt oder ins Image "mitgenommen" werden. Werden cgi- und rc-Skript abgewählt, so steht dem Benutzer die alt bekannte binary-Version zur Verfügung, die er allerdings selbst händisch starten und verwalten muss. Für das in sispmctl integrierte Webinterface stehen jetzt zusätzliche Skins zur Verfügung, die ebenfalls über menuconfig ausgewählt werden können.
<figure><img src="/screenshots/210.jpg" alt="sispmctl in menuconfig" /><figcaption>sispmctl in menuconfig</figcaption></figure>
</p>
<h2 id="Platzbedarf">Platzbedarf</h2>
<p>
Cgi und rc-Skript beanspruchen im Flash circa 4kB. Der Unterschied im Binary mit und ohne Webserver ist 6kB. Die Skins beinhalten jeweils ein Bildchen und einige html-Dateien, was pro Skin etwa 10&hellip;16kB an Zusatzplatz kostet.
</p>
<h2 id="manpage">manpage</h2>
<p>
Auf der Kommandozeile gibt <tt>sispmctl -h</tt> eine kurze Übersicht über die Optionen. Die <a class="ext-link" href="http://sispmctl.sourceforge.net/#mozTocId756141"><span class="icon">​</span>man-page</a> findet sich aber auch auf der Homepage des Projekts.
</p>
<pre class="wiki">root@fritz:/var/mod/root# sispmctl -h

SiS PM Control for Linux 3.0

(C) 2004-2011 by Mondrian Nuessle, (C) 2005, 2006 by Andreas Neuper.
(C) 2010 by Olivier Matheret for the plannification part
This program is free software.
sispmctl comes with ABSOLUTELY NO WARRANTY; for details
see the file INSTALL. This is free software, and you are welcome
to redistribute it under certain conditions; see the file INSTALL
for details.

sispmctl -s
sispmctl [-q] [-n] [-d 0...] [-D ...] -b &lt;on|off&gt;
sispmctl [-q] [-n] [-d 0...] [-D ...] -[o|f|t|g|m] 1..4|all
sispmctl [-q] [-n] [-d 0...] [-D ...] -[a|A] 1..4|all [--Aat '...'] [--Aafter ...] [--Ado &lt;on|off&gt;] ... [--Aloop ...]
   'v'   - print version &amp; copyright
   'h'   - print this usage information
   's'   - scan for supported GEMBIRD devices
   'b'   - switch buzzer on or off
   'o'   - switch outlet(s) on
   'f'   - switch outlet(s) off
   't'   - toggle outlet(s) on/off
   'g'   - get status of outlet(s)
   'm'   - get power supply status outlet(s) on/off
   'd'   - apply to device 'n'
   'D'   - apply to device with given serial number
   'n'   - show result numerically
   'q'   - quiet mode, no explanations - but errors
   'a'   - get plannification for outlet
   'A'   - set plannification for outlet
           '-A&lt;num&gt;'        - select outlet
           '--Aat "date"'   - sets an event time as a date '%Y-%m-%d %H:%M'
           '--Aafter N'     - sets an event time as N minutes after the previous one
           '--Ado &lt;on|off&gt;' - sets the current event's action
           '--Aloop N'      - loops to 1st event's action after N minutes

Webinterface features:
sispmctl [-q] [-i &lt;ip&gt;] [-p &lt;#port&gt;] [-u &lt;path&gt;] -l
   'l'   - start port listener
   'i'   - bind socket on interface with given IP (dotted decimal, i.e. 192.168.1.1)
   'p'   - port number for listener (2638)
   'u'   - repository for web pages (default=/usr/share/sispmctl)
</pre><h2 id="BekannteBugs">Bekannte Bugs</h2>
<p>
Das integrierte Web-Interface ist sehr empfindlich gegenüber Störungen auf dem USB-Bus bzw. gegenüber falscher Byte-Sequenzen auf dem lauschenden Port. Beides führt zu einem sicheren Absturz vom Webserver. Zu erkennen sind solche Abstürze dadurch, dass der Web-Browser auf dem besagten Port eine Zeitüberschreitung meldet bzw. sispmctl-Dienst in FREETZ als "stopped" vermeldet wird. Ein manueller Wiederstart des intgrierten Web-Interfaces ist nach einem solchen Absturz möglich.
</p>
<h2 id="WeiterführendeLinks">Weiterführende Links</h2>
<ul><li><a class="ext-link" href="http://sispmctl.sourceforge.net/"><span class="icon">​</span>Homepage von sispmctl</a> (Englisch)
</li><li><a class="ext-link" href="http://www.ip-phone-forum.de/showthread.php?t=232493&amp;p=1690967&amp;viewfull=1#post1690967"><span class="icon">​</span>Version 1.0 von sispmctl-cgi auf IPPF</a>
</li><li><a class="ext-link" href="http://www.ip-phone-forum.de/showthread.php?t=232493&amp;p=1695596&amp;viewfull=1#post1695596"><span class="icon">​</span>Version 1.1 von sispmctl-cgi auf IPPF</a>
</li><li><a href="/ticket/1264">Ticket #1264 im trac</a>
</li><li><a href="/ticket/1677">Ticket #1677 im trac</a>
</li></ul><h2 id="WeitereScreenshots">Weitere Screenshots</h2>
<p>
<figure><img src="/screenshots/208.jpg" alt="Hauptskin von sispmctl" /><figcaption>Hauptskin von sispmctl</figcaption></figure>
<figure><img src="/screenshots/211.jpg" alt="Smartphone-Skin von sispmctl" /><figcaption>Smartphone-Skin von sispmctl</figcaption></figure>
</p>
<br clear="all" />
</div>

      </div><ul class="tags"><li class="header">Tags</li><li><a href="/tags/homeautomation" rel="tag">homeautomation</a> </li><li><a href="../packages.html" rel="tag">packages</a> </li><li><a href="/tags/usb" rel="tag">usb</a> </li></ul>

    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("/chrome/screenshots/css/screenshots.css", "text/css");
    </script>
    </div>
  </body>
</html>
